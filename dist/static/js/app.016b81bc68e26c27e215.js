webpackJsonp([2,0],[function(t,e,a){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}var s=a(36),n=r(s),i=a(91),c=r(i),u=a(38),o=r(u);window.SOUNDCLOUD_API_KEY="781f5b35a83b232906c2f9f28164d5a5",new n.default({el:"#app",store:o.default,render:function(t){return t(c.default)}})},,,,,,,,,,,,,,,,,,,,,function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=a(35);e.default={computed:{currentTrackIndex:function(){var t=this;return(0,r.findIndex)(this.tracks,function(e){return e.id===t.currentTrack.id})}},methods:{playingAndCurrentTrack:function(t){return"PLAYING"===this.playback.playState&&t.id===this.currentTrack.id},playingOrPausedAndNotCurrentTrack:function(t){return"IDLE"!==this.playback.playState&&t.id!==this.currentTrack.id},playTrack:function(t){var e=this;return t.streamable?("IDLE"===this.playback.playState?(this.setPlayState("PLAYING"),this.player.play({streamUrl:t.stream_url})):this.playingAndCurrentTrack(t)?(this.setPlayState("PAUSED"),this.player.pause()):this.playingOrPausedAndNotCurrentTrack(t)?(this.setPlayState("PLAYING"),this.player.play({streamUrl:t.stream_url})):(this.setPlayState("PLAYING"),this.player.play({streamUrl:t.stream_url})),setTimeout(function(){e.setCurrentTrack(t)},0),this.player.on("ended",function(){e.nextTrack()}),void this.player.on("timeupdate",function(){e.setTrackProgress(e.player.audio.currentTime)})):(this.player.stop(),this.setPlayState("IDLE"),this.setCurrentTrack({}),window.alert("Sorry, this track is not streamable."),!1)},playTrackAtIndex:function(t){return t===-1?(this.setPlayState("IDLE"),!1):void this.playTrack(this.tracks[t])},nextTrack:function t(){var e=this,a=void 0;switch(this.playback.repeatState){case"OFF":a=this.currentTrackIndex===this.tracks.length-1?-1:this.currentTrackIndex+1;break;case"ON":a=this.currentTrackIndex===this.tracks.length-1?0:this.currentTrackIndex+1;break;case"ONE":a=this.currentTrackIndex}var t=this.tracks[a];return t.streamable?(this.player.stop(),this.setPlayState("PLAYING"),this.player.play({streamUrl:t.stream_url}),void setTimeout(function(){e.setCurrentTrack(t)},0)):(this.player.stop(),this.setPlayState("IDLE"),this.setCurrentTrack({}),window.alert("Sorry, this track is not streamable."),!1)},prevTrack:function t(){var e=this,a=void 0;switch(this.playback.repeatState){case"OFF":a=0===this.currentTrackIndex?0:this.currentTrackIndex-1;break;case"ON":a=0===this.currentTrackIndex?0:this.currentTrackIndex-1;break;case"ONE":a=this.currentTrackIndex}var t=this.tracks[a];return t.streamable?(this.player.stop(),this.setPlayState("PLAYING"),this.player.play({streamUrl:t.stream_url}),void setTimeout(function(){e.setCurrentTrack(t)},0)):(this.player.stop(),this.setPlayState("IDLE"),this.setCurrentTrack({}),window.alert("Sorry, this track is not streamable."),!1)},pauseTrack:function(){this.setPlayState("PAUSED"),this.player.pause()},unpauseTrack:function(){this.setPlayState("PLAYING"),this.player.play({streamUrl:this.currentTrack.stream_url})}}}},function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.SET_CURRENT_TRACK="SET_CURRENT_TRACK",e.SET_TRACKS="SET_TRACKS",e.ADD_TRACK="ADD_TRACK",e.REMOVE_TRACK="REMOVE_TRACK",e.SET_PLAYER="SET_PLAYER",e.SET_PROGRESS="SET_PROGRESS",e.SET_PLAY_STATE="SET_PLAY_STATE",e.SET_REPEAT_STATE="SET_REPEAT_STATE",e.SET_SHUFFLE_STATE="SET_SHUFFLE_STATE",e.SET_VOLUME="SET_VOLUME"},,,,,,,,,,,,,,,function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default={mounted:function(){var t=this;document.addEventListener("keyup",function(e){switch(e.keyCode){case 40:t.nextTrack();break;case 38:t.prevTrack();break;case 32:"IDLE"===t.playback.playState?t.playTrackAtIndex(0):"PLAYING"===t.playback.playState?t.pauseTrack():t.unpauseTrack();break;case 82:t.setRepeatState();break;case 83:t.shuffleTracks()}},!1)}}},function(t,e,a){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var s=a(36),n=r(s),i=a(2),c=r(i),u=a(40),o=r(u),l=a(39),d=r(l);n.default.use(c.default),e.default=new c.default.Store({modules:{tracks:o.default,playback:d.default}})},function(t,e,a){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var s,n=a(23),i=r(n),c=a(22),u={player:null,progress:0,playState:"IDLE",repeatState:"OFF",shuffleState:"OFF",volume:50},o={player:function(t){return t.player}},l={setPlayer:function(t,e){var a=t.commit;a(c.SET_PLAYER,e)},setPlayState:function(t,e){var a=t.commit;a(c.SET_PLAY_STATE,e)},setTrackProgress:function(t,e){var a=t.commit;a(c.SET_PROGRESS,e)},setShuffleState:function(t,e){var a=t.commit;a(c.SET_SHUFFLE_STATE,e)},setRepeatState:function(t){var e=t.commit,a=t.state,r=void 0;switch(a.repeatState){case"OFF":r="ON";break;case"ON":r="ONE";break;case"ONE":r="OFF"}e(c.SET_REPEAT_STATE,r)}},d=(s={},(0,i.default)(s,c.SET_PLAYER,function(t,e){t.player=e}),(0,i.default)(s,c.SET_PROGRESS,function(t,e){t.progress=e}),(0,i.default)(s,c.SET_PLAY_STATE,function(t,e){t.playState=e}),(0,i.default)(s,c.SET_REPEAT_STATE,function(t,e){t.repeatState=e}),(0,i.default)(s,c.SET_SHUFFLE_STATE,function(t,e){t.shuffleState=e}),(0,i.default)(s,c.SET_VOLUME,function(t,e){t.volume=e}),s);e.default={state:u,getters:o,actions:l,mutations:d}},function(t,e,a){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var s,n=a(23),i=r(n),c=a(80),u=a(22),o=a(35),l={currentTrack:{},tracks:[]},d={currentTrack:function(t){return t.currentTrack},tracks:function(t){return t.tracks}},f={addTrack:function(t,e){var a=t.commit;return new c.Promise(function(t,r){a(u.ADD_TRACK,e),t()})},removeTrack:function(t,e){var a=t.commit;return new c.Promise(function(t,r){a(u.REMOVE_TRACK,e),t()})},setTracks:function(t,e){var a=t.commit;return new c.Promise(function(t,r){a(u.SET_TRACKS,e),t()})},setCurrentTrack:function(t,e){var a=t.commit;a(u.SET_CURRENT_TRACK,e)},shuffleTracks:function(t){var e=t.commit,a=t.state;e(u.SET_TRACKS,(0,o.shuffle)(a.tracks))}},p=(s={},(0,i.default)(s,u.SET_CURRENT_TRACK,function(t,e){t.currentTrack=e}),(0,i.default)(s,u.SET_TRACKS,function(t,e){t.tracks=e}),(0,i.default)(s,u.ADD_TRACK,function(t,e){(0,o.isArray)(e)?t.tracks=t.tracks.concat(e):t.tracks=t.tracks.concat([e])}),(0,i.default)(s,u.REMOVE_TRACK,function(t,e){t.tracks.splice(e,1)}),s);e.default={state:l,getters:d,actions:f,mutations:p}},function(t,e,a){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var s=a(3),n=r(s),i=a(90),c=r(i),u=a(20),o=r(u),l=a(2),d=a(93),f=r(d),p=a(94),k=r(p),h=a(95),y=r(h);e.default={name:"App",data:function(){return{url:"",badTracks:[]}},computed:(0,n.default)({},(0,l.mapState)(["playback"]),(0,l.mapGetters)(["tracks","player"])),methods:(0,n.default)({},(0,l.mapActions)(["addTrack","setPlayer"]),{addNewTrackFromUrl:function(){var t=this;this.badTracks=[],this.player.resolve(this.url,function(e){if(e.hasOwnProperty("tracks")){var a=e.tracks.filter(function(t){return t.streamable});t.badTracks=e.tracks.filter(function(t){return!t.streamable}).map(function(t){return t.title}),t.addTrack(a).then(function(){(0,o.default)("tracks",t.tracks)})}else e.streamable?t.addTrack(e).then(function(){(0,o.default)("tracks",t.tracks)}):t.badTracks.push(e.title);t.url=""})}}),mounted:function(){this.setPlayer(new c.default(window.SOUNDCLOUD_API_KEY)),(0,o.default)("tracks")&&this.addTrack((0,o.default)("tracks"))},components:{PlaybackControls:f.default,Playlist:k.default,Visualizer:y.default}}},function(t,e,a){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var s=a(3),n=r(s),i=a(20),c=r(i),u=a(2);e.default={name:"audio-track",props:["track","playstate","index"],computed:(0,n.default)({},(0,u.mapGetters)(["currentTrack","tracks","player"]),{isCurrentTrack:function(){return this.track.id===this.currentTrack.id}}),methods:(0,n.default)({},(0,u.mapActions)(["setCurrentTrack","removeTrack","setPlayState"]),{doRemoveTrack:function(t){var e=this;this.tracks[t].id===this.currentTrack.id&&(this.player.stop(),this.setPlayState("IDLE"),this.setCurrentTrack({})),this.removeTrack(t).then(function(){(0,c.default)("tracks",e.tracks)})}})}},function(t,e,a){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var s=a(3),n=r(s),i=a(2),c=a(37),u=r(c),o=a(21),l=r(o);e.default={mixins:[u.default,l.default],computed:(0,n.default)({},(0,i.mapState)(["playback"]),(0,i.mapGetters)(["currentTrack","tracks","player"]),{currentTrackDuration:function(){return this.currentTrack.duration/1e3}}),methods:(0,n.default)({},(0,i.mapActions)(["setPlayState","setCurrentTrack","setShuffleState","setRepeatState","setTrackProgress","shuffleTracks"]),{doPlayTrack:function(){"IDLE"===this.playback.playState?this.playTrackAtIndex(0):"PLAYING"===this.playback.playState?this.pauseTrack():this.unpauseTrack()},seek:function(t){this.player.seek(t)},toggleShuffleState:function(){"ON"===this.playback.shuffleState?this.setShuffleState("OFF"):this.setShuffleState("ON")}})}},function(t,e,a){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var s=a(3),n=r(s),i=a(2),c=a(21),u=r(c),o=a(92),l=r(o),d=a(20),f=r(d),p=a(89),k=r(p);e.default={name:"Playlist",props:["tracks"],mixins:[u.default],mounted:function(){var t=this;k.default.create(this.$refs.playlist,{animation:150,delay:150,onUpdate:function(e){var a=e.oldIndex,r=e.newIndex,s=a,n=r;t.tracks.splice(n,0,t.tracks.splice(s,1)[0]),setTimeout(function(){t.setTracks(t.tracks).then(function(){(0,f.default)("tracks",t.tracks)})},0)}})},computed:(0,n.default)({},(0,i.mapState)(["playback"]),(0,i.mapGetters)(["currentTrack","player"])),methods:(0,n.default)({},(0,i.mapActions)(["setCurrentTrack","setTracks","setPlayState","setTrackProgress"])),components:{AudioTrack:l.default}}},function(t,e,a){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var s=a(46),n=r(s),i=a(3),c=r(i),u=a(2);e.default={props:["binCount","smoothing"],data:function(){return{playerHasBeenInit:!1,analyserNode:null,frequencyByteData:new Uint8Array(this.binCount),streamData:[]}},computed:(0,c.default)({},(0,u.mapGetters)(["player"])),watch:{player:function(t){var e=this;this.player.audio.crossOrigin="anonymous",this.player.on("playing",function(){e.playerHasBeenInit||e.initAudioAnalyser(),e.playerHasBeenInit=!0},0)}},methods:{initAudioAnalyser:function(){var t=new(window.AudioContext||window.webkitAudioContext),e=t.createMediaElementSource(this.player.audio);this.analyserNode=t.createAnalyser(),this.analyserNode.fftSize=2*this.binCount,this.analyserNode.smoothingTimeConstant=this.smoothing,e.connect(this.analyserNode),this.analyserNode.connect(t.destination),this.initDataStream()},updateSample:function(){this.analyserNode.getByteFrequencyData(this.frequencyByteData),this.streamData=(0,n.default)(this.frequencyByteData)},initDataStream:function(){this.updateSample(),window.requestAnimationFrame(this.initDataStream)}}}},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(t,e){},function(t,e){},function(t,e){},function(t,e){},function(t,e){},,,,,,function(t,e,a){var r,s;a(85),r=a(41);var n=a(100);s=r=r||{},"object"!=typeof r.default&&"function"!=typeof r.default||(s=r=r.default),"function"==typeof s&&(s=s.options),s.render=n.render,s.staticRenderFns=n.staticRenderFns,t.exports=r},function(t,e,a){var r,s;a(83),r=a(42);var n=a(98);s=r=r||{},"object"!=typeof r.default&&"function"!=typeof r.default||(s=r=r.default),"function"==typeof s&&(s=s.options),s.render=n.render,s.staticRenderFns=n.staticRenderFns,t.exports=r},function(t,e,a){var r,s;a(84),r=a(43);var n=a(99);s=r=r||{},"object"!=typeof r.default&&"function"!=typeof r.default||(s=r=r.default),"function"==typeof s&&(s=s.options),s.render=n.render,s.staticRenderFns=n.staticRenderFns,t.exports=r},function(t,e,a){var r,s;a(81),r=a(44);var n=a(96);s=r=r||{},"object"!=typeof r.default&&"function"!=typeof r.default||(s=r=r.default),"function"==typeof s&&(s=s.options),s.render=n.render,s.staticRenderFns=n.staticRenderFns,t.exports=r},function(t,e,a){var r,s;a(82),r=a(45);var n=a(97);s=r=r||{},"object"!=typeof r.default&&"function"!=typeof r.default||(s=r=r.default),"function"==typeof s&&(s=s.options),s.render=n.render,s.staticRenderFns=n.staticRenderFns,t.exports=r},function(t,e){t.exports={render:function(){var t=this;return t._h("ul",{ref:"playlist",staticClass:"playlist",on:{keydown:function(t){t.preventDefault()}}},[t._l(t.tracks,function(e,a){return t._h("audio-track",{key:e.id,attrs:{track:e,playstate:t.playback.playState,index:a},nativeOn:{click:function(a){t.playTrack(e)}}})})])},staticRenderFns:[]}},function(t,e){t.exports={render:function(){var t=this;return t._h("div",{staticClass:"lines"},[t._l(t.streamData,function(e,a){return t._h("div",{staticClass:"line",style:{height:e+"px"}})})])},staticRenderFns:[]}},function(t,e){t.exports={render:function(){var t=this;return t._h("li",{staticClass:"track",class:{active:t.isCurrentTrack,"not-streamable":!t.track.streamable}},[t.track.streamable?t._e():t._h("div",{staticClass:"track-state",attrs:{title:"This track is not streamable"}},[t._h("i",{staticClass:"fa fa-warning"})])," ",t.isCurrentTrack?t._h("div",{staticClass:"track-state"},[t._h("i",{staticClass:"fa",class:{"fa-play":"PAUSED"==t.playstate,"fa-pause":"PLAYING"==t.playstate}})]):t._e()," ",t._h("div",{staticClass:"track-name"},[t._s(t.track.title)])," ",t._h("div",{staticClass:"remove-track",on:{click:function(e){e.stopPropagation(),t.doRemoveTrack(t.index)}}},["×"])])},staticRenderFns:[]}},function(t,e){t.exports={render:function(){var t=this;return t._h("div",{staticClass:"playback-controls"},[t._h("div",{staticClass:"playback-control prev fa fa-backward",on:{click:t.prevTrack}})," ",t._h("div",{staticClass:"playback-control playPause fa",class:{"fa-play":"PAUSED"==t.playback.playState||"IDLE"==t.playback.playState,"fa-pause":"PLAYING"==t.playback.playState},on:{click:t.doPlayTrack}})," ",t._h("div",{staticClass:"playback-control next fa fa-forward",on:{click:t.nextTrack}})," "," ",t._h("div",{staticClass:"playback-control repeat fa fa-refresh",class:"repeat-"+t.playback.repeatState.toLowerCase(),on:{click:t.setRepeatState}})," ",t._h("progress",{staticClass:"track-progress",attrs:{max:t.currentTrackDuration,value:t.playback.progress},on:{click:t.seek}})])},staticRenderFns:[]}},function(t,e){t.exports={render:function(){var t=this;return t._h("div",{attrs:{id:"app"}},[t._h("visualizer",{attrs:{"bin-count":128,smoothing:.8}})," ",t._m(0)," ",t._h("div",{staticClass:"main"},[t._h("div",{staticClass:"header-bar"},[t._h("form",{staticClass:"addTrackForm",on:{submit:function(e){e.preventDefault(),t.addNewTrackFromUrl(e)}}},[t._h("input",{directives:[{name:"model",rawName:"v-model",value:t.url,expression:"url"}],attrs:{type:"text",placeholder:"SoundCloud URL"},domProps:{value:t._s(t.url)},on:{keyup:function(t){t.stopPropagation()},input:function(e){e.target.composing||(t.url=e.target.value)}}})])," "])," ",t._h("div",{staticClass:"playback-controls-container"},[t._h("playback-controls")])," ",t._h("div",{staticClass:"playlist-container"},[t.badTracks.length?t._h("div",{staticClass:"track-errors"},[t._h("div",{staticClass:"track-errors-hide",on:{click:function(e){t.badTracks=[]}}},["×"])," ",t._h("div",{staticClass:"track-errors-message"},[t._h("p",["The following tracks were unable to be added because they are not streamable:"])," ",t._h("ul",[t._l(t.badTracks,function(e){return t._h("li",[t._s(e)])})])])]):t._e()," ",t._h("playlist",{attrs:{tracks:t.tracks}})])])," ",t._m(1)])},staticRenderFns:[function(){var t=this;return t._h("div",{staticClass:"logo"},[t._h("img",{attrs:{src:"static/images/logo.svg",alt:"Constatune"}})])},function(){var t=this;return t._h("div",{staticClass:"footer"},[t._h("a",{attrs:{href:"https://soundcloud.com",target:"_blank",rel:"noopener"}},[t._h("img",{attrs:{src:"static/images/sc.png",alt:"Powered by SoundCloud",width:"52",height:"16"}})])," ",t._h("div",{staticClass:"footer-links"},[t._h("div",{staticClass:"footer-author"},["A project by ",t._h("a",{attrs:{href:"http://syropia.net",target:"_blank",rel:"noopener"}},["Syropia"]),"."])," ",t._h("a",{attrs:{href:"#"}},["About"])," ",t._h("a",{attrs:{href:"https://github.com/syropian/constantune",target:"_blank",rel:"noopener"}},["GitHub"])])])}]}},,function(t,e){}]);
//# sourceMappingURL=app.016b81bc68e26c27e215.js.map